<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://www.lunasdk.org/manual/basics/serialization_and_deserialization/" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Serialization and Deserialization - Luna SDK Docs</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Serialization and Deserialization";
        var mkdocs_page_input_path = "manual\\basics\\serialization_and_deserialization.md";
        var mkdocs_page_url = "/manual/basics/serialization_and_deserialization/";
      </script>
    
    <script src="../../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> Luna SDK Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../license/">License</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../roadmap/">Roadmap</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Manual</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="#">Introduction</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../introduction/">Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../introduction/getting_started/">Getting Started</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Basics</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../">Basics</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../coding_convention/">Coding Convention</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../initialization_and_shutdown/">Initialization and Shutdown</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../basic_types/">Basic Types</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../strings/">Strings</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../memory_management/">Memory Management</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../modules/">Modules</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../variants/">Variants</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../type_system/">Type System</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="./">Serialization and Deserialization</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#default-serialization-and-deserialization-behavior">Default serialization and deserialization behavior</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../boxed_objects/">Boxed Objects</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../interfaces/">Interfaces</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../error_handling/">Error Handling</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../assertions/">Assertions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../file_management/">File Management</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../thread_and_synchronization_objects/">Thread and Synchronization Objects</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../time/">Time</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../logs/">Logs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../math_library/">Math Library</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">Luna SDK Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Manual &raquo;</li>
          <li>Basics &raquo;</li>
      <li>Serialization and Deserialization</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="serialization-and-deserialization">Serialization and Deserialization</h1>
<pre><code class="language-c++">#include &lt;Luna/Runtime/Serialization.hpp&gt;
</code></pre>
<p>Luna SDK comes with a built-in serialization and deserialization library that can serialize objects of serializable types to <a href="../variants/"><code>Variant</code></a> objects, with can then be encoded to byte streams using JSON or other text and binary formats. One type must meets the following requirements to be a serializable type:</p>
<ol>
<li>This type has been registered to the <a href="../type_system/">type system</a>.</li>
<li>This type is marked as serializable by calling <code>set_serializable</code>.</li>
</ol>
<p><code>set_serializable</code> accepts one optional <code>SerializableTypeDesc</code> structure, which let the user set serialization and deserialization callback functions for the type. If this structure is not provided, the default serialization and deserialization procedure will be used. For generic structure types, <code>set_serializable</code> will be applied to all instanced types of that generic type. The user can also call <code>set_serializable</code> on one specific instanced type to override the serialization and deserialization behavior set on the generic type.</p>
<p>For any serializable objects, the user can call <code>serialize</code> to serialize one object to one <code>Variant</code>, and call <code>deserialize</code> to deserialize one object from one <code>Variant</code>.</p>
<h2 id="default-serialization-and-deserialization-behavior">Default serialization and deserialization behavior</h2>
<p>The default serialization procedure checks the type of the object, then returns one <code>Variant</code> object based on the following rules:</p>
<ol>
<li>For structure types, the returned <code>Variant</code> will be an object of serializable properties, indexed by their property names. The data of every property is generated by another <code>serialize</code> call. Unserializable properties will be ignored.</li>
<li>For single enumeration types, the returned <code>Variant</code> will be the name of the option that matches the underlying value of the object. If no option matches the underlying value, the serialization function will throw <code>BasicError::bad_data</code> error. </li>
<li>For multiple enumeration types, the returned <code>Variant</code> will be an array that contains names of all selected options. If no option is selected, an empty <code>Variant</code> array will be returned.</li>
</ol>
<p>The default deserialization procedure checks the type of the object, then assigns the data of the object based on the following rules:</p>
<ol>
<li>For structure types, <code>deserialize</code> is called for every serializable property of the object with the data of that property. Properties without data in <code>Variant</code> and unrecognized properties will be ignored.</li>
<li>For single enumeration types, the default deserialization function reads the name string stored in <code>Variant</code>, and assigns the enumeration object with the value whose option name matches the data. If no option matches the name string stored in <code>Variant</code>, the deserialization function will throw <code>BasicError::bad_data</code> error.</li>
<li>For multiple enumeration types, the default deserialization function firstly clears the object to <code>0</code>, then reads the array of strings stored in <code>Variant</code>, and sets corresponding bits in the target object. Unrecognized options will be ignored.</li>
</ol>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../type_system/" class="btn btn-neutral float-left" title="Type System"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../boxed_objects/" class="btn btn-neutral float-right" title="Boxed Objects">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../type_system/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../boxed_objects/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme_extra.js" defer></script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
